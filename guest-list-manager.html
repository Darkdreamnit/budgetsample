<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GYTHNW4T2S"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GYTHNW4T2S');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Use our guest list manager to keep track of your guests rsvps, food preferences, and many more factors.">
    <title>Online Guest List Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
    
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
     <!-- Header -->
    <header class="gradient-bg text-white">
        <div class="container mx-auto px-4 py-8">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-money-bill-wave text-3xl"></i>
                    <h2 class="text-2xl font-bold">Event Budget Sample</h2>
                </div>
                <nav class="hidden md:flex space-x-6">
                    <a href="index.html" class="hover:text-indigo-200 transition">Home</a>
                    <a href="calculator.html" class="hover:text-indigo-200 transition">Calculator</a>
                    <a href="guest-list-manager.html" class="hover:text-indigo-200 transition">Guest List Manager</a>
                    <a href="event-checklist-generator.html" class="hover:text-indigo-200 transition">Event Checklist Generator</a>
                    <a href="resources.html" class="hover:text-indigo-200 transition">Resources</a>
                    <a href="contact.html" class="hover:text-indigo-200 transition">Contact</a>
                </nav>
                <button id="mobileMenuButton" class="md:hidden text-xl">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobileMenu" class="mobile-menu md:hidden bg-indigo-700 rounded-lg mt-4">
                <div class="flex flex-col space-y-3 p-4">
                    <a href="index.html" class="hover:text-indigo-200 transition">Home</a>
                    <a href="calculator.html" class="hover:text-indigo-200 transition">Calculator</a>
                    <a href="guest-list-manager.html" class="hover:text-indigo-200 transition">Guest List Manager</a>
                    <a href="event-checklist-generator.html" class="hover:text-indigo-200 transition">Event Checklist Generator</a>
                    <a href="resources.html" class="hover:text-indigo-200 transition">Resources</a>
                    <a href="contact.html" class="hover:text-indigo-200 transition">Contact</a>
                </div>
            </div>

            <div class="mt-16 mb-20 text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-4">Online Guest List Manager</h1>
                <p class="text-xl md:text-2xl max-w-3xl mx-auto">Use our guest list manager to help get your guestlist in  order.</p>
                <p>
                    You will be able to track RSVps, manage each guest and guest categories, and you will also be able to visualize the data.
                    </p>
                    <p>Don't forget to export your data when you are done.
                        </p>

            </div>
        </div>
    </header>
    <div class="container mx-auto px-4 py-8">
        <div class="text-center mb-12">
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Add Guest Form -->
            <div class="lg:col-span-1 bg-white rounded-2xl shadow-xl p-6 h-fit border border-gray-100">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">Add Guest</h2>
                    <div class="w-10 h-10 rounded-full gradient-bg flex items-center justify-center text-white">
                        <i class="fas fa-user-plus"></i>
                    </div>
                </div>
                <form id="guestForm" class="space-y-5">
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Full Name <span class="text-red-500">*</span></label>
                        <input type="text" id="guestName" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none" placeholder="John Smith" required>
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Email</label>
                        <input type="email" id="guestEmail" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none" placeholder="john@example.com">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Phone</label>
                        <input type="tel" id="guestPhone" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none" placeholder="(123) 456-7890">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">RSVP Status</label>
                        <select id="guestStatus" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                            <option value="pending">Pending</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="declined">Declined</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Category</label>
                        <div class="flex space-x-2 mb-2">
                            <select id="guestCategory" class="flex-1 px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                                <option value="general">General</option>
                                <option value="vip">VIP</option>
                                <option value="speaker">Speaker</option>
                                <option value="sponsor">Sponsor</option>
                                <option value="staff">Staff</option>
                            </select>
                            <button type="button" onclick="addCustomCategory()" class="px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <input type="text" id="customCategory" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none hidden" placeholder="New category name">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Meal Preference</label>
                        <select id="guestMeal" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                            <option value="none">Not specified</option>
                            <option value="vegetarian">Vegetarian</option>
                            <option value="vegan">Vegan</option>
                            <option value="gluten-free">Gluten-free</option>
                            <option value="regular">Regular</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Special Notes</label>
                        <textarea id="guestNotes" rows="3" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none" placeholder="Allergies, special requests..."></textarea>
                    </div>

                    <button type="submit" class="w-full gradient-bg text-white py-3 px-6 rounded-xl font-medium hover:opacity-90 transition flex items-center justify-center space-x-2 glow">
                        <i class="fas fa-user-plus animate-bounce"></i>
                        <span>Add Guest</span>
                    </button>
                </form>
            </div>

            <!-- Guest List and Stats -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white rounded-2xl shadow p-6 border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500">Total Guests</p>
                                <h3 class="text-3xl font-bold text-gray-800" id="totalGuests">0</h3>
                            </div>
                            <div class="p-3 rounded-full bg-blue-100 text-blue-600">
                                <i class="fas fa-users text-2xl"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl shadow p-6 border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500">Confirmed</p>
                                <h3 class="text-3xl font-bold text-green-600" id="confirmedGuests">0</h3>
                            </div>
                            <div class="p-3 rounded-full bg-green-100 text-green-600">
                                <i class="fas fa-check-circle text-2xl"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl shadow p-6 border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500">Declined</p>
                                <h3 class="text-3xl font-bold text-red-600" id="declinedGuests">0</h3>
                            </div>
                            <div class="p-3 rounded-full bg-red-100 text-red-600">
                                <i class="fas fa-times-circle text-2xl"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-white rounded-2xl shadow p-6 border border-gray-100">
                        <h3 class="font-semibold text-gray-800 mb-4 text-lg">RSVP Status</h3>
                        <canvas id="rsvpChart" height="200"></canvas>
                    </div>
                    <div class="bg-white rounded-2xl shadow p-6 border border-gray-100">
                        <h3 class="font-semibold text-gray-800 mb-4 text-lg">Guest Categories</h3>
                        <canvas id="categoryChart" height="200"></canvas>
                    </div>
                </div>

                <!-- Guest List -->
                <div class="bg-white rounded-2xl shadow overflow-hidden border border-gray-100">
                    <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                        <h2 class="text-2xl font-semibold text-gray-800">Guest List</h2>
                        <div class="flex space-x-2">
                            <button onclick="exportToExcel()" class="px-4 py-2 bg-green-100 text-green-700 rounded-xl hover:bg-green-200 transition flex items-center space-x-2">
                                <i class="fas fa-file-excel"></i>
                                <span>Excel</span>
                            </button>
                            <button onclick="exportToPDF()" class="px-4 py-2 bg-red-100 text-red-700 rounded-xl hover:bg-red-200 transition flex items-center space-x-2">
                                <i class="fas fa-file-pdf"></i>
                                <span>PDF</span>
                            </button>
                            <button onclick="importFromExcel()" class="px-4 py-2 gradient-bg-info text-white rounded-xl hover:opacity-90 transition flex items-center space-x-2 file-upload-btn">
                                <i class="fas fa-file-import"></i>
                                <span>Import Excel</span>
                            </button>
                            <button onclick="confirmClearData()" class="px-4 py-2 gradient-bg-secondary text-white rounded-xl hover:opacity-90 transition flex items-center space-x-2">
                                <i class="fas fa-trash-alt"></i>
                                <span>Clear Data</span>
                            </button>
                        </div>
                    </div>
                    <div class="p-4">
                        <div class="flex items-center justify-between mb-4">
                            <div class="relative w-72">
                                <input type="text" id="searchGuests" placeholder="Search guests..." class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-300 focus:outline-none focus:border-blue-500">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                            <div class="flex space-x-2">
                                <select id="filterStatus" class="px-4 py-2 rounded-xl border border-gray-300 focus:outline-none">
                                    <option value="all">All Statuses</option>
                                    <option value="pending">Pending</option>
                                    <option value="confirmed">Confirmed</option>
                                    <option value="declined">Declined</option>
                                </select>
                                <select id="filterCategory" class="px-4 py-2 rounded-xl border border-gray-300 focus:outline-none">
                                    <option value="all">All Categories</option>
                                </select>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Meal</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="guestList" class="bg-white divide-y divide-gray-200">
                                    <!-- Guest rows will be added here dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Guest Modal -->
    <div id="editModal" class="fixed inset-0 modal-overlay flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 transform transition-all duration-300 scale-95">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">Edit Guest</h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <form id="editForm" class="space-y-4">
                    <input type="hidden" id="editId">
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Full Name <span class="text-red-500">*</span></label>
                        <input type="text" id="editName" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none" required>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Email</label>
                        <input type="email" id="editEmail" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Phone</label>
                        <input type="tel" id="editPhone" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">RSVP Status</label>
                        <select id="editStatus" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                            <option value="pending">Pending</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="declined">Declined</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Category</label>
                        <select id="editCategory" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                            <!-- Categories will be added dynamically -->
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Meal Preference</label>
                        <select id="editMeal" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none">
                            <option value="none">Not specified</option>
                            <option value="vegetarian">Vegetarian</option>
                            <option value="vegan">Vegan</option>
                            <option value="gluten-free">Gluten-free</option>
                            <option value="regular">Regular</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Special Notes</label>
                        <textarea id="editNotes" rows="3" class="w-full px-4 py-3 rounded-xl border border-gray-300 input-highlight focus:outline-none"></textarea>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" onclick="closeModal()" class="px-6 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-100 transition">Cancel</button>
                        <button type="submit" class="px-6 py-2 gradient-bg text-white rounded-xl hover:opacity-90 transition">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="fixed inset-0 modal-overlay flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 p-6 transform transition-all duration-300 scale-95">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4">
                    <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-medium text-gray-900 mb-2">Are you sure?</h3>
                <p class="text-gray-500 mb-6">This will permanently delete all guest data. This action cannot be undone.</p>
                <div class="flex justify-center space-x-4">
                    <button type="button" onclick="closeConfirmModal()" class="px-6 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-100 transition">
                        Cancel
                    </button>
                    <button type="button" onclick="clearAllData()" class="px-6 py-2 gradient-bg-secondary text-white rounded-xl hover:opacity-90 transition">
                        Yes, Clear All Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="fixed inset-0 modal-overlay flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 p-6 transform transition-all duration-300 scale-95">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 mb-4">
                    <i class="fas fa-file-excel text-blue-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-medium text-gray-900 mb-2">Import Guests from Excel</h3>
                <p class="text-gray-500 mb-4">Select an Excel file to import guest data. The file should match the export format.</p>
                
                <div class="mt-6">
                    <input type="file" id="fileInput" accept=".xlsx, .xls" />
                    <label for="fileInput" class="cursor-pointer gradient-bg-info text-white py-3 px-6 rounded-xl font-medium hover:opacity-90 transition inline-flex items-center space-x-2">
                        <i class="fas fa-file-upload"></i>
                        <span>Choose Excel File</span>
                    </label>
                </div>
                
                <div id="importPreview" class="mt-6 max-h-60 overflow-y-auto hidden">
                    <h4 class="font-medium text-gray-700 mb-2">Preview (first 5 rows)</h4>
                    <table class="min-w-full divide-y divide-gray-200 text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-3 py-2 text-left font-medium text-gray-500">Name</th>
                                <th class="px-3 py-2 text-left font-medium text-gray-500">Status</th>
                                <th class="px-3 py-2 text-left font-medium text-gray-500">Category</th>
                            </tr>
                        </thead>
                        <tbody id="previewTable" class="bg-white divide-y divide-gray-200">
                            <!-- Preview rows will be added here -->
                        </tbody>
                    </table>
                </div>
                
                <div class="flex justify-center space-x-4 mt-6">
                    <button type="button" onclick="closeImportModal()" class="px-6 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-100 transition">
                        Cancel
                    </button>
                    <button type="button" id="confirmImportBtn" onclick="processImport()" class="px-6 py-2 gradient-bg-success text-white rounded-xl hover:opacity-90 transition hidden">
                        <i class="fas fa-check mr-2"></i> Confirm Import
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize guest list and categories
        let guests = [];
        let categories = ['general', 'vip', 'speaker', 'sponsor', 'staff'];
        let rsvpChart, categoryChart;
        let importData = []; // Store imported data temporarily

        // DOM elements
        const guestForm = document.getElementById('guestForm');
        const editForm = document.getElementById('editForm');
        const guestList = document.getElementById('guestList');
        const searchInput = document.getElementById('searchGuests');
        const filterStatus = document.getElementById('filterStatus');
        const filterCategory = document.getElementById('filterCategory');
        const editModal = document.getElementById('editModal');
        const confirmModal = document.getElementById('confirmModal');
        const importModal = document.getElementById('importModal');
        const customCategoryInput = document.getElementById('customCategory');
        const guestCategorySelect = document.getElementById('guestCategory');
        const fileInput = document.getElementById('fileInput');
        const importPreview = document.getElementById('importPreview');
        const previewTable = document.getElementById('previewTable');
        const confirmImportBtn = document.getElementById('confirmImportBtn');

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Load any saved data from localStorage
            loadData();
            
            // Initialize charts
            initCharts();
            
            // Populate category filters
            updateCategoryFilters();
            
            // Set up event listeners
            setupEventListeners();
            
            // Render initial guest list
            renderGuestList();
        });

        function loadData() {
            const savedGuests = localStorage.getItem('guests');
            const savedCategories = localStorage.getItem('categories');
            
            if (savedGuests) {
                guests = JSON.parse(savedGuests);
            }
            
            if (savedCategories) {
                categories = JSON.parse(savedCategories);
                // Update the category select dropdowns
                updateCategorySelects();
            }
        }

        function saveData() {
            localStorage.setItem('guests', JSON.stringify(guests));
            localStorage.setItem('categories', JSON.stringify(categories));
        }

        function setupEventListeners() {
            // Add guest form submission
            guestForm.addEventListener('submit', function(e) {
                e.preventDefault();
                addGuest();
            });
            
            // Edit guest form submission
            editForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveEditedGuest();
            });
            
            // Search and filter listeners
            searchInput.addEventListener('input', renderGuestList);
            filterStatus.addEventListener('change', renderGuestList);
            filterCategory.addEventListener('change', renderGuestList);
            
            // File input change listener
            fileInput.addEventListener('change', handleFileSelect);
        }

        function addGuest() {
            const name = document.getElementById('guestName').value.trim();
            const email = document.getElementById('guestEmail').value.trim();
            const phone = document.getElementById('guestPhone').value.trim();
            const status = document.getElementById('guestStatus').value;
            const category = document.getElementById('guestCategory').value;
            const meal = document.getElementById('guestMeal').value;
            const notes = document.getElementById('guestNotes').value.trim();
            
            if (!name) {
                alert('Please enter a guest name');
                return;
            }
            
            const newGuest = {
                id: Date.now().toString(),
                name,
                email,
                phone,
                status,
                category,
                meal,
                notes,
                createdAt: new Date().toISOString()
            };
            
            guests.push(newGuest);
            saveData();
            renderGuestList();
            updateCharts();
            updateStats();
            
            // Reset form
            guestForm.reset();
            
            // Show success message with animation
            const addButton = document.querySelector('#guestForm button[type="submit"]');
            addButton.innerHTML = '<i class="fas fa-check mr-2"></i> Guest Added!';
            addButton.classList.remove('gradient-bg');
            addButton.classList.add('gradient-bg-success');
            
            setTimeout(() => {
                addButton.innerHTML = '<i class="fas fa-user-plus mr-2"></i> Add Guest';
                addButton.classList.remove('gradient-bg-success');
                addButton.classList.add('gradient-bg');
            }, 2000);
        }

        function renderGuestList() {
            const searchTerm = searchInput.value.toLowerCase();
            const statusFilter = filterStatus.value;
            const categoryFilter = filterCategory.value;
            
            // Filter guests based on search and filters
            const filteredGuests = guests.filter(guest => {
                const matchesSearch = guest.name.toLowerCase().includes(searchTerm) || 
                                      (guest.email && guest.email.toLowerCase().includes(searchTerm)) || 
                                      (guest.phone && guest.phone.toLowerCase().includes(searchTerm));
                const matchesStatus = statusFilter === 'all' || guest.status === statusFilter;
                const matchesCategory = categoryFilter === 'all' || guest.category === categoryFilter;
                
                return matchesSearch && matchesStatus && matchesCategory;
            });
            
            // Clear current list
            guestList.innerHTML = '';
            
            if (filteredGuests.length === 0) {
                guestList.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                            <i class="fas fa-user-slash text-4xl text-gray-300 mb-2"></i>
                            <p>No guests found</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Add filtered guests to the table
            filteredGuests.forEach(guest => {
                const row = document.createElement('tr');
                row.className = 'guest-card hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${guest.name}</div>
                                <div class="text-sm text-gray-500">${formatDate(guest.createdAt)}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${guest.email || 'N/A'}</div>
                        <div class="text-sm text-gray-500">${guest.phone || 'N/A'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusClass(guest.status)}">
                            ${capitalizeFirstLetter(guest.status)}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <span class="px-2 py-1 bg-gray-100 rounded-full">${capitalizeFirstLetter(guest.category)}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${guest.meal === 'none' ? 'N/A' : capitalizeFirstLetter(guest.meal)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button onclick="editGuest('${guest.id}')" class="text-blue-600 hover:text-blue-900 mr-3 transition" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteGuest('${guest.id}')" class="text-red-600 hover:text-red-900 transition" title="Delete">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                guestList.appendChild(row);
            });
        }

        function getStatusClass(status) {
            switch(status) {
                case 'pending': return 'status-pending';
                case 'confirmed': return 'status-confirmed';
                case 'declined': return 'status-declined';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function editGuest(id) {
            const guest = guests.find(g => g.id === id);
            if (!guest) return;
            
            document.getElementById('editId').value = guest.id;
            document.getElementById('editName').value = guest.name;
            document.getElementById('editEmail').value = guest.email || '';
            document.getElementById('editPhone').value = guest.phone || '';
            document.getElementById('editStatus').value = guest.status;
            document.getElementById('editMeal').value = guest.meal;
            document.getElementById('editNotes').value = guest.notes || '';
            
            // Populate category select in edit modal
            const editCategorySelect = document.getElementById('editCategory');
            editCategorySelect.innerHTML = '';
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = capitalizeFirstLetter(category);
                if (category === guest.category) option.selected = true;
                editCategorySelect.appendChild(option);
            });
            
            // Show modal with animation
            editModal.classList.remove('hidden');
            setTimeout(() => {
                document.querySelector('#editModal > div').classList.remove('scale-95');
                document.querySelector('#editModal > div').classList.add('scale-100');
            }, 10);
        }

        function saveEditedGuest() {
            const id = document.getElementById('editId').value;
            const guestIndex = guests.findIndex(g => g.id === id);
            
            if (guestIndex === -1) return;
            
            const name = document.getElementById('editName').value.trim();
            if (!name) {
                alert('Please enter a guest name');
                return;
            }
            
            guests[guestIndex] = {
                ...guests[guestIndex],
                name,
                email: document.getElementById('editEmail').value.trim(),
                phone: document.getElementById('editPhone').value.trim(),
                status: document.getElementById('editStatus').value,
                category: document.getElementById('editCategory').value,
                meal: document.getElementById('editMeal').value,
                notes: document.getElementById('editNotes').value.trim()
            };
            
            saveData();
            renderGuestList();
            updateCharts();
            updateStats();
            closeModal();
            
            // Show success toast
            showToast('Guest updated successfully!', 'success');
        }

        function deleteGuest(id) {
            if (!confirm('Are you sure you want to delete this guest?')) return;
            
            guests = guests.filter(guest => guest.id !== id);
            saveData();
            renderGuestList();
            updateCharts();
            updateStats();
            
            // Show success toast
            showToast('Guest deleted successfully!', 'warning');
        }

        function closeModal() {
            document.querySelector('#editModal > div').classList.remove('scale-100');
            document.querySelector('#editModal > div').classList.add('scale-95');
            setTimeout(() => {
                editModal.classList.add('hidden');
            }, 200);
        }

        function confirmClearData() {
            if (guests.length === 0) {
                alert('There is no data to clear!');
                return;
            }
            
            // Show confirmation modal with animation
            confirmModal.classList.remove('hidden');
            setTimeout(() => {
                document.querySelector('#confirmModal > div').classList.remove('scale-95');
                document.querySelector('#confirmModal > div').classList.add('scale-100');
            }, 10);
        }

        function closeConfirmModal() {
            document.querySelector('#confirmModal > div').classList.remove('scale-100');
            document.querySelector('#confirmModal > div').classList.add('scale-95');
            setTimeout(() => {
                confirmModal.classList.add('hidden');
            }, 200);
        }

        function clearAllData() {
            guests = [];
            categories = ['general', 'vip', 'speaker', 'sponsor', 'staff'];
            saveData();
            renderGuestList();
            updateCharts();
            updateStats();
            updateCategoryFilters();
            closeConfirmModal();
            
            // Show success toast
            showToast('All data cleared successfully!', 'error');
        }

        function addCustomCategory() {
            if (customCategoryInput.classList.contains('hidden')) {
                // Show the input field
                customCategoryInput.classList.remove('hidden');
                guestCategorySelect.classList.add('hidden');
                customCategoryInput.focus();
            } else {
                // Add the new category
                const newCategory = customCategoryInput.value.trim().toLowerCase();
                if (newCategory && !categories.includes(newCategory)) {
                    categories.push(newCategory);
                    saveData();
                    updateCategorySelects();
                    updateCategoryFilters();
                    
                    // Select the new category
                    document.getElementById('guestCategory').value = newCategory;
                    
                    // Show success toast
                    showToast(`Category "${capitalizeFirstLetter(newCategory)}" added!`, 'success');
                }
                
                // Hide the input field
                customCategoryInput.classList.add('hidden');
                guestCategorySelect.classList.remove('hidden');
                customCategoryInput.value = '';
            }
        }

        function updateCategorySelects() {
            const selects = [guestCategorySelect, document.getElementById('editCategory'), filterCategory];
            
            selects.forEach(select => {
                if (!select) return;
                
                // Save current value
                const currentValue = select.value;
                
                // Clear existing options (except "All Categories" for filter)
                if (select.id === 'filterCategory') {
                    select.innerHTML = '<option value="all">All Categories</option>';
                } else {
                    select.innerHTML = '';
                }
                
                // Add all categories
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = capitalizeFirstLetter(category);
                    select.appendChild(option);
                });
                
                // Restore current value if it still exists
                if (categories.includes(currentValue)) {
                    select.value = currentValue;
                }
            });
        }

        function updateCategoryFilters() {
            const filterSelect = document.getElementById('filterCategory');
            filterSelect.innerHTML = '<option value="all">All Categories</option>';
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = capitalizeFirstLetter(category);
                filterSelect.appendChild(option);
            });
        }

        function initCharts() {
            const rsvpCtx = document.getElementById('rsvpChart').getContext('2d');
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            
            rsvpChart = new Chart(rsvpCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Pending', 'Confirmed', 'Declined'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: [
                            '#f59e0b',
                            '#10b981',
                            '#ef4444'
                        ],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Poppins',
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            bodyFont: {
                                family: 'Poppins'
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
            
            categoryChart = new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Guests by Category',
                        data: [],
                        backgroundColor: '#6b73ff',
                        borderRadius: 6,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0,
                                font: {
                                    family: 'Poppins'
                                }
                            },
                            grid: {
                                display: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    family: 'Poppins'
                                }
                            }
                        }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        bodyFont: {
                            family: 'Poppins'
                        }
                    }
                }
            }
        });
        
        updateCharts();
    }

    function updateCharts() {
        // Update RSVP chart
        const pending = guests.filter(g => g.status === 'pending').length;
        const confirmed = guests.filter(g => g.status === 'confirmed').length;
        const declined = guests.filter(g => g.status === 'declined').length;
        
        rsvpChart.data.datasets[0].data = [pending, confirmed, declined];
        rsvpChart.update();
        
        // Update category chart
        const categoryCounts = {};
        categories.forEach(cat => {
            categoryCounts[cat] = guests.filter(g => g.category === cat).length;
        });
        
        categoryChart.data.labels = categories.map(c => capitalizeFirstLetter(c));
        categoryChart.data.datasets[0].data = categories.map(c => categoryCounts[c]);
        categoryChart.update();
    }

    function updateStats() {
        document.getElementById('totalGuests').textContent = guests.length;
        document.getElementById('confirmedGuests').textContent = guests.filter(g => g.status === 'confirmed').length;
        document.getElementById('declinedGuests').textContent = guests.filter(g => g.status === 'declined').length;
    }

    function exportToExcel() {
        if (guests.length === 0) {
            alert('No guests to export!');
            return;
        }
        
        // Prepare data for export
        const data = [
            ['Name', 'Email', 'Phone', 'Status', 'Category', 'Meal Preference', 'Notes', 'Date Added']
        ];
        
        guests.forEach(guest => {
            data.push([
                guest.name,
                guest.email || '',
                guest.phone || '',
                capitalizeFirstLetter(guest.status),
                capitalizeFirstLetter(guest.category),
                guest.meal === 'none' ? 'N/A' : capitalizeFirstLetter(guest.meal),
                guest.notes || '',
                formatDate(guest.createdAt)
            ]);
        });
        
        // Create workbook
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(data);
        XLSX.utils.book_append_sheet(wb, ws, 'Guest List');
        
        // Export to file
        XLSX.writeFile(wb, 'guest_list.xlsx');
        
        // Show success toast
        showToast('Exported to Excel successfully!', 'success');
    }

    function exportToPDF() {
        if (guests.length === 0) {
            alert('No guests to export!');
            return;
        }
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // Add title
        doc.setFontSize(18);
        doc.setFont('helvetica', 'bold');
        doc.text('Guest List', 105, 15, { align: 'center' });
        
        // Add date
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 105, 22, { align: 'center' });
        
        // Prepare data for table
        const headers = ['Name', 'Email', 'Phone', 'Status', 'Category', 'Meal', 'Date Added'];
        const rows = guests.map(guest => [
            guest.name,
            guest.email || 'N/A',
            guest.phone || 'N/A',
            capitalizeFirstLetter(guest.status),
            capitalizeFirstLetter(guest.category),
            guest.meal === 'none' ? 'N/A' : capitalizeFirstLetter(guest.meal),
            formatDate(guest.createdAt)
        ]);
        
        // Add table
        doc.autoTable({
            head: [headers],
            body: rows,
            startY: 30,
            styles: {
                fontSize: 9,
                cellPadding: 2,
                font: 'helvetica'
            },
            headStyles: {
                fillColor: [107, 115, 255],
                textColor: 255,
                fontStyle: 'bold'
            },
            alternateRowStyles: {
                fillColor: [240, 240, 240]
            }
        });
        
        // Save the PDF
        doc.save('guest_list.pdf');
        
        // Show success toast
        showToast('Exported to PDF successfully!', 'success');
    }

    function importFromExcel() {
        // Show import modal
        importModal.classList.remove('hidden');
        setTimeout(() => {
            document.querySelector('#importModal > div').classList.remove('scale-95');
            document.querySelector('#importModal > div').classList.add('scale-100');
        }, 10);
    }

    function closeImportModal() {
        document.querySelector('#importModal > div').classList.remove('scale-100');
        document.querySelector('#importModal > div').classList.add('scale-95');
        setTimeout(() => {
            importModal.classList.add('hidden');
            // Reset import state
            importData = [];
            importPreview.classList.add('hidden');
            confirmImportBtn.classList.add('hidden');
            fileInput.value = '';
        }, 200);
    }

    function handleFileSelect(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: 'array' });
            
            // Get first worksheet
            const worksheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[worksheetName];
            
            // Convert to JSON
            const jsonData = XLSX.utils.sheet_to_json(worksheet);
            
            if (jsonData.length === 0) {
                alert('The Excel file is empty!');
                return;
            }
            
            // Store the imported data temporarily
            importData = jsonData;
            
            // Show preview
            showImportPreview();
        };
        reader.readAsArrayBuffer(file);
    }

    function showImportPreview() {
        // Clear previous preview
        previewTable.innerHTML = '';
        
        // Show first 5 rows for preview
        const previewRows = importData.slice(0, 5);
        
        previewRows.forEach(row => {
            const tr = document.createElement('tr');
            tr.className = 'hover:bg-gray-50';
            tr.innerHTML = `
                <td class="px-3 py-2 whitespace-nowrap">${row.Name || 'N/A'}</td>
                <td class="px-3 py-2 whitespace-nowrap">${row.Status ? capitalizeFirstLetter(row.Status) : 'Pending'}</td>
                <td class="px-3 py-2 whitespace-nowrap">${row.Category ? capitalizeFirstLetter(row.Category) : 'General'}</td>
            `;
            previewTable.appendChild(tr);
        });
        
        // Show the preview section
        importPreview.classList.remove('hidden');
        confirmImportBtn.classList.remove('hidden');
    }

    function processImport() {
        if (importData.length === 0) return;
        
        // Process each imported row
        importData.forEach(row => {
            // Skip if name is missing
            if (!row.Name) return;
            
            // Check if this guest already exists (by name)
            const existingIndex = guests.findIndex(g => g.name.toLowerCase() === row.Name.toLowerCase());
            
            const guestData = {
                id: Date.now().toString(),
                name: row.Name,
                email: row.Email || '',
                phone: row.Phone || '',
                status: (row.Status || 'pending').toLowerCase(),
                category: (row.Category || 'general').toLowerCase(),
                meal: (row['Meal Preference'] || 'none').toLowerCase(),
                notes: row.Notes || '',
                createdAt: new Date().toISOString()
            };
            
            if (existingIndex >= 0) {
                // Update existing guest
                guests[existingIndex] = guestData;
            } else {
                // Add new guest
                guests.push(guestData);
            }
            
            // Add new categories if they don't exist
            if (row.Category && !categories.includes(row.Category.toLowerCase())) {
                categories.push(row.Category.toLowerCase());
            }
        });
        
        // Save the data
        saveData();
        
        // Update UI
        updateCategorySelects();
        updateCategoryFilters();
        renderGuestList();
        updateCharts();
        updateStats();
        
        // Close the modal
        closeImportModal();
        
        // Show success message
        showToast(`Successfully imported ${importData.length} guests!`, 'success');
    }

    function showToast(message, type) {
        const toast = document.createElement('div');
        let bgColor = 'bg-blue-500';
        
        switch(type) {
            case 'success': bgColor = 'bg-green-500'; break;
            case 'warning': bgColor = 'bg-yellow-500'; break;
            case 'error': bgColor = 'bg-red-500'; break;
        }
        
        toast.className = `fixed bottom-4 right-4 ${bgColor} text-white px-6 py-3 rounded-xl shadow-lg flex items-center space-x-2 transform transition-all duration-300 translate-y-4 opacity-0`;
        toast.innerHTML = `
            <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-times-circle'}"></i>
            <span>${message}</span>
        `;
        
        document.body.appendChild(toast);
        
        setTimeout(() => {
            toast.classList.remove('translate-y-4');
            toast.classList.remove('opacity-0');
            toast.classList.add('translate-y-0');
            toast.classList.add('opacity-100');
        }, 10);
        
        setTimeout(() => {
            toast.classList.remove('translate-y-0');
            toast.classList.remove('opacity-100');
            toast.classList.add('translate-y-4');
            toast.classList.add('opacity-0');
            
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 300);
        }, 3000);
    }

    // Helper functions
    function capitalizeFirstLetter(string) {
        if (!string) return '';
        return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();
    }

    function formatDate(dateString) {
        const options = { year: 'numeric', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString(undefined, options);
    }
</script>
<!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-8">
                <!-- Column 1 -->
                <div>
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-money-bill-wave mr-2"></i>
                        Event Budget Sample
                    </h3>
                    <p class="text-gray-400">Choice of professionals for accurate event budgeting since 2025.</p>
                </div>

                <!-- Column 2 -->
                <div>
                    <h4 class="font-bold mb-4">Resources</h4>
                    <ul class="space-y-2">
                        <li><a href="how-to-make-a-budget-for-an-event.html" class="text-gray-400 hover:text-white transition">How to make a budget for an event</a></li>
                       
                    </ul>
                </div>

                <!-- Column 3 -->
                <div>
                    <h4 class="font-bold mb-4">Company</h4>
                    <ul class="space-y-2">
                        <li><a href="about-us.html" class="text-gray-400 hover:text-white transition">About Us</a></li>
                       
                    </ul>
                </div>

                <!-- Column 4 -->
                <div>
                    <h4 class="font-bold mb-4">Contact</h4>
                    <ul class="space-y-2">
                        <li class="flex items-center">
                            <i class="fas fa-envelope mr-2 text-gray-400"></i>
                            <a href="mailto:hello@eventbudgetpro.com" class="text-gray-400 hover:text-white transition">eventbudgetsample@gmail.com</a>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone mr-2 text-gray-400"></i>
                            <a href="tel:+18005551234" class="text-gray-400 hover:text-white transition">(757) 949-4621</a>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-map-marker-alt mr-2 text-gray-400"></i>
                            <span class="text-gray-400">Virginia Beach, VA</span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2025 Event Budget Sample. All rights reserved.</p>
            </div>
        </div>
    </footer>
    <script src="index.js"></script>
</body>

</html>